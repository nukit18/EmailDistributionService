# gRPC Email Distribution Service

Микросервис для рассылки писем с сервисной почты.

**Разработан с использованием gRPC + Django ORM.**

**Доступны два метода:**
1) Отправка сообщения.
    - На вход принимает название шаблона, список email’ов получателей и данные для
формирования письма
    - Предусмотрена защита от повторных отправок тому же получателю (с тем же содержимым)

2) Статистика отправки писем.
    - На вход передаётся email. 
    - Возвращается: общее количество писем,
отправленных на данный email, и количество отправленных писем по каждому из
шаблонов.


## Важная информация

Перед запуском контейнеров **обязательно** создайте файл `.env`. Структура задана в `.env.example`. 
Подключение к БД можно не изменять, но настройки сервисной почты **обязательно**.


## Запуск проекта

Чтобы запустить проект, выполните следующие команды:

1. Создайте файл `.env`.
   
2. Запустите сборку и запуск контейнеров:

    ```bash
    docker compose up --build -d
    ```

## Примечания
- После запуска контейнеров можете запустить скрипт клиента `email_distribution_service_client.py`
для проверки, но нужно заполнить в нем почты.
- Protobuf-файл лежит в ./proto
- Контейнер с БД также поднимается и заполняется тестовыми данными (шаблонами писем).
- Доступны 3 шаблона для писем:
    - welcome_letter (переменные: user_name, project_name)
    - reset_password (переменные: user_name, reset_link, expires_in)
    - order_confirmation (переменные: user_name, order_id, store_name)
